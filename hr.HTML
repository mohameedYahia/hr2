<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> إجراءات الموارد البشرية - Paradise</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #0a0a1a;
            --primary-accent: #6660e3;
            --secondary-accent: #b571f5;
            --text-color: #e5e7eb;
            --card-bg: rgba(23, 23, 39, 0.7);
            --border-color: rgba(58, 223, 151, 0.2);
            --success-color: #22c55e;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --pending-color: #6b7280;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            overflow-x: hidden;
        }

        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .details-card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        .details-card:hover {
            box-shadow: 0 0 25px rgba(58, 223, 151, 0.1);
        }

        .animated-entry {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeIn 0.6s ease-out forwards;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* AS-IS TO-BE Diagram */
        .info-node { cursor: pointer; }
        .asis-tobe-node { width: 140px; height: 140px; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; color: white; font-weight: bold; position: relative; transition: all 0.4s ease; }
        .asis-tobe-node .shape { position: absolute; inset: 0; border-radius: 1.5rem; transform: rotate(45deg); z-index: -1; transition: all 0.4s ease; }
        .asis-tobe-node:hover { transform: scale(1.05); }
        .info-node.active .shape { transform: rotate(60deg) scale(1.1); box-shadow: 0 0 25px var(--primary-accent); }
        .asis-node .shape { background-color: #374151; border: 2px solid #4b5563; }
        .tobe-node .shape { background-color: var(--primary-accent); border: 2px solid #818cf8; }
        .info-pill { font-weight: bold; padding: 0.25rem 0.75rem; border-radius: 9999px; transition: all 0.3s ease; }
        .info-pill:hover { transform: scale(1.05); }
        .info-node.active.info-pill { box-shadow: 0 0 15px var(--secondary-accent); transform: scale(1.1); }
        .info-node.active.gap-label { text-shadow: 0 0 10px var(--warning-color); transform: scale(1.1); }
        .gap-line { width: 100%; height: 4px; background-image: linear-gradient(to left, var(--warning-color) 50%, transparent 50%); background-size: 16px 4px; }

        /* Procedures List Styles */
        #procedures-list { max-height: 70vh; overflow-y: auto; }
        .accordion-header { display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; background-color: rgba(0,0,0,0.2); border-radius: 0.5rem; cursor: pointer; transition: background-color 0.3s; }
        .accordion-header:hover { background-color: rgba(255,255,255,0.1); }
        .accordion-header .chevron { transition: transform 0.3s ease; }
        .accordion-header.open .chevron { transform: rotate(180deg); }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-in-out; }
        .procedure-item { padding: 0.75rem 1rem 0.75rem 1.5rem; cursor: pointer; transition: all 0.2s ease; border-right: 4px solid transparent; }
        .procedure-item:hover { background-color: rgba(255, 255, 255, 0.05); border-right-color: var(--secondary-accent); transform: translateX(-5px); }
        .procedure-item.active { background: linear-gradient(to left, rgba(102, 96, 227, 0.3), transparent); border-right-color: var(--primary-accent); color: white; font-weight: 700; transform: translateX(-5px); }

        /* Details Panel Animation */
        #procedure-details-panel { min-height: 500px; }
        .details-content-wrapper { transition: opacity 0.4s ease-in-out; }
        .details-content-wrapper.loading { opacity: 0; }
        
        /* Loading Spinner */
        .spinner { width: 56px; height: 56px; border-radius: 50%; border: 5px solid rgba(255,255,255,0.2); border-top-color: var(--secondary-accent); animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Procedure Stepper */
        .procedure-stepper { display: flex; align-items: flex-start; justify-content: space-between; gap: 2px; padding: 8px 0; overflow-x: auto; }
        .step { display: flex; flex-direction: column; align-items: center; text-align: center; flex-basis: 80px; flex-shrink: 0; position: relative; cursor: pointer; }
        .step-icon { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 18px; font-weight: bold; transition: all 0.3s ease; border: 3px solid; margin-bottom: 8px; position: relative; }
        .step:hover .step-icon { transform: scale(1.1); }
        .step.active .step-icon { transform: scale(1.15); box-shadow: 0 0 20px var(--secondary-accent); }
        .step-label { font-size: 12px; font-weight: 500; transition: color 0.3s ease; white-space: nowrap; }
        .step-line { flex-grow: 1; height: 3px; margin-top: 18.5px; transition: background-color: 0.3s ease; }

        /* Step Status Colors */
        .step.completed .step-icon { background-color: var(--success-color); border-color: var(--success-color); }
        .step.completed.active .step-icon { border-color: var(--secondary-accent); }
        .step.completed .step-label { color: var(--success-color); }
        .step-line.completed { background-color: var(--success-color); }
        .step.inprogress .step-icon { background-color: var(--warning-color); border-color: var(--warning-color); animation: pulse 2s infinite; }
        .step.inprogress.active .step-icon { animation: none; border-color: var(--secondary-accent); }
        .step.inprogress .step-label { color: var(--warning-color); }
        .step-line.pending { background-color: var(--pending-color); }
        .step.pending .step-icon { background-color: transparent; border-color: var(--pending-color); }
        .step.pending.active .step-icon { border-color: var(--secondary-accent); }
        .step.pending .step-label { color: #9ca3af; }

        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(245, 158, 11, 0); } 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); } }
        
        /* SVG Flowchart Styles */
        .svg-flowchart { width: 100%; height: auto; min-height: 500px; font-size: 10px; }
        .svg-flowchart .flow-line { stroke: var(--warning-color); stroke-width: 2.5; fill: none; stroke-dasharray: 1000; stroke-dashoffset: 1000; animation: draw-line 1.5s ease-out forwards; }
        @keyframes draw-line { to { stroke-dashoffset: 0; } }
        .svg-flowchart .flow-box { opacity: 0; animation: fade-in-box 0.5s ease-out forwards; }
        @keyframes fade-in-box { to { opacity: 1; } }
        .svg-flowchart .box-content { background-color: #2c2a4a; border: 1px solid var(--primary-accent); border-radius: 0.5rem; padding: 0.4rem; text-align: center; color: var(--text-color); height: 100%; display: flex; align-items: center; justify-content: center; line-height: 1.4; }
        .svg-flowchart .box-content.start-end { background-color: var(--primary-accent); }
        .svg-flowchart .header-text { fill: var(--text-color); font-weight: bold; font-size: 11px; }

    </style>
</head>
<body class="flex flex-col min-h-screen">

    <canvas id="bg-canvas"></canvas>

    <header class="bg-black/30 backdrop-blur-sm shadow-md sticky top-0 z-50 border-b border-slate-700">
        <nav class="container mx-auto px-6 py-3 flex items-center justify-between">
            <div class="flex items-center">
                <img src="Image (11).png" alt="Paradise Logo" class="h-12 w-auto">
            </div>
            <div class="flex items-center">
                <img src="Image (4).png" alt="شعار الجهة" class="h-12 w-auto">
            </div>
        </nav>
    </header>

    <main id="main-content" class="flex-grow p-4 md:p-8">
        <div class="max-w-7xl mx-auto">

            <!-- Project Intro Section -->
            <div class="details-card p-4 rounded-2xl animated-entry mb-8">
                <h2 class="text-xl md:text-2xl font-bold text-center text-indigo-300 mb-2">إجراءات الموارد البشرية - Paradise AI</h2>
                <div class="w-full border-t border-teal-400/20 my-3"></div>
                <h3 class="text-base font-bold text-center text-teal-300 mb-3">فريق العمل</h3>
                <div class="flex flex-wrap justify-center gap-x-8 gap-y-2 text-sm">
                    <div class="flex flex-col items-center gap-1 text-center">
                        <span class="bg-purple-500/20 text-purple-300 p-2 rounded-full">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path></svg>
                        </span>
                        <div>
                            <p class="font-bold text-sm text-slate-100">CTO</p>
                            <p class="text-slate-400 text-xs">تحت رعاية وإشراف</p>
                            <p class="font-semibold text-sm">د. حـسـام الفـرماوي</p>
                        </div>
                    </div>
                    <div class="flex flex-col items-center gap-1 text-center">
                        <span class="bg-pink-500/20 text-pink-300 p-2 rounded-full">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>
                        </span>
                        <div>
                            <p class="font-bold text-sm text-slate-100">استشاري التنفيذ</p>
                            <p class="font-semibold text-sm">م. مـحمـد يـحي</p>
                            <p class="font-semibold text-sm">م. مـونيكا ريمون</p>
                        </div>
                    </div>
                    <div class="flex flex-col items-center gap-1 text-center">
                        <span class="bg-sky-500/20 text-sky-300 p-2 rounded-full">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg>
                        </span>
                        <div>
                            <p class="font-bold text-sm text-slate-100">مطوّر التنفيذ</p>
                            <p class="font-semibold text-sm">م. تسنيم محمد ذكـي</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AS-IS TO-BE Section -->
            <div class="details-card p-6 rounded-2xl animated-entry mb-8" style="animation-delay: 0.2s;">
                <div class="flex flex-col md:flex-row items-center justify-center gap-8">
                    <div id="asis-node" class="info-node asis-tobe-node asis-node" data-desc="الاعتماد على دورات عمل ورقية يدوية مما يؤدي إلى بطء في تنفيذ الإجراءات، صعوبة في تتبع الطلبات، زيادة احتمالية الأخطاء البشرية، وصعوبة استخراج تقارير دقيقة لدعم اتخاذ القرار.">
                        <div class="shape"></div>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 opacity-80" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h5M5.75 9.25A8.001 8.001 0 0120.25 9.25" /><path stroke-linecap="round" stroke-linejoin="round" d="M20 20v-5h-5M18.25 14.75A8.001 8.001 0 013.75 14.75" /></svg>
                        <p class="mt-2 text-lg">الوضع الحالي</p>
                    </div>
                    <div class="flex-grow max-w-xs text-center">
                         <div id="analysis-pill" class="info-node info-pill text-indigo-300 bg-indigo-500/20 inline-block mb-2" data-desc="دراسة الوضع الحالي لتحديد نقاط الضعف، الإجراءات غير الفعالة، والفرص المتاحة للتحسين.">التحليل</div>
                         <div class="gap-line"></div>
                         <p id="gap-label" class="info-node gap-label text-yellow-400 font-bold my-1 transition-transform duration-300" data-desc="تحديد الفارق بين الأداء الحالي (AS-IS) والأداء المستهدف (TO-BE) لوضع أهداف واضحة للمشروع.">الفجوة (GAP)</p>
                         <div id="solution-pill" class="info-node info-pill text-pink-300 bg-pink-500/20 inline-block mt-2" data-desc="تصميم وتطبيق حلول تقنية وإجرائية، متمثلة في نظام الـ ERP، لسد الفجوة وتحقيق الأهداف المرجوة.">الحلول</div>
                    </div>
                    <div id="tobe-node" class="info-node asis-tobe-node tobe-node" data-desc="تطبيق نظام ERP مركزي يوفر واجهات سهلة، أتمتة كاملة لسير العمل، تتبع لحظي للطلبات، وتقارير تحليلية متقدمة لتحسين الكفاءة التشغيلية.">
                        <div class="shape"></div>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                        <p class="mt-2 text-lg">الوضع المستهدف</p>
                    </div>
                </div>
                <div id="asis-tobe-description" class="mt-4 text-center bg-slate-800/50 p-3 rounded-lg min-h-[50px] flex items-center justify-center transition-all duration-300">
                    <p>اضغط على أحد عناصر الرسم التوضيحي لعرض الوصف.</p>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Right Column: Procedures List -->
                <div class="lg:col-span-1 animated-entry" style="animation-delay: 0.4s;">
                    <div class="details-card p-4 rounded-2xl">
                        <h3 class="text-xl font-bold text-teal-300 mb-4 px-2">قائمة الإجراءات</h3>
                        <div id="procedures-list" class="space-y-2"></div>
                    </div>
                </div>

                <!-- Left Column: Details Panel -->
                <div class="lg:col-span-2 animated-entry" style="animation-delay: 0.6s;">
                    <div id="procedure-details-panel" class="details-card p-6 rounded-2xl sticky top-24 flex items-center justify-center">
                         <!-- Spinner and content will be injected here -->
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <footer class="mt-16 border-t border-slate-800"><div class="container mx-auto px-6 py-4 text-center text-slate-400"><p>&copy; تم تطوير هذا العرض التفاعلي بواسطة Paradise - 2025</p></div></footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- 3D Background Setup ---
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ canvas: document.querySelector('#bg-canvas'), alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            const starCount = 5000;
            const positions = new Float32Array(starCount * 3);
            for (let i = 0; i < starCount; i++) {
                positions[i * 3 + 0] = (Math.random() - 0.5) * 2000;
                positions[i * 3 + 1] = (Math.random() - 0.5) * 2000;
                positions[i * 3 + 2] = (Math.random() - 0.5) * 2000;
            }
            const starGeometry = new THREE.BufferGeometry();
            starGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            const starMaterial = new THREE.PointsMaterial({ color: 0xaaaaaa, size: 0.7 });
            const starField = new THREE.Points(starGeometry, starMaterial);
            scene.add(starField);
            camera.position.z = 5;
            function animate() {
                requestAnimationFrame(animate);
                starField.rotation.x += 0.0001;
                starField.rotation.y += 0.0002;
                renderer.render(scene, camera);
            }
            animate();
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });

            // --- Data Declarations ---
            const stageDetails = {
                analysis: { label: 'تحليل', icon: '🔍', description: "جمع وتوثيق جميع متطلبات العمل. المخرج الرئيسي هو مستند متطلبات وظيفية (FRD)." },
                design: { label: 'تصميم', icon: '📐', description: "تحويل المتطلبات إلى تصميم فني ووظيفي مفصل. المخرج هو مستند التصميم الوظيفي (FDD)." },
                development: { label: 'تطوير', icon: '💻', description: "مرحلة البناء الفعلي للنظام، وتكوين الوحدات القياسية وبرمجة التخصيصات." },
                deployment: { label: 'نشر وتطبيق', icon: '🚩', description: "تشمل هذه المرحلة اختبار قبول المستخدم (UAT) وتدريب المستخدمين النهائيين على النظام الجديد لضمان جاهزيتهم للتشغيل الفعلي." },
                golive: { label: 'تشغيل', icon: '🚀', description: "المرحلة النهائية لإطلاق النظام وتقديم الدعم الفني بعد الإطلاق." }
            };
            
            const flowchartLibrary = {
                illicitGainAnalysis: `
                    <svg viewBox="0 0 400 650" class="svg-flowchart" style="direction: rtl; min-height: 650px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="200" y="15" class="header-text" text-anchor="middle">إجراء الكسب غير المشروع</text>

                        <!-- Start -->
                        <foreignObject x="125" y="40" width="150" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 إنشاء ملف شبهة مالية</div>
                        </foreignObject>
                        <path d="M 200 100 V 125" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>
                        
                        <!-- Step 2 -->
                        <foreignObject x="125" y="125" width="150" height="60" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">طلب الرأي من الشؤون المالية</div>
                        </foreignObject>
                        <path d="M 200 185 V 210" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- Step 3 -->
                        <foreignObject x="125" y="210" width="150" height="60" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">فحص الشائعات وإعداد تقرير</div>
                        </foreignObject>
                        <path d="M 200 270 V 295" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>

                        <!-- Decision -->
                        <g transform="translate(200, 325) rotate(45)" class="flow-box" style="animation-delay: 1.2s;">
                           <rect x="-30" y="-30" width="60" height="60" fill="#2c2a4a" stroke="var(--primary-accent)"></rect>
                           <text x="0" y="5" fill="var(--text-color)" transform="rotate(-45)" text-anchor="middle">القرار؟</text>
                        </g>
                        
                        <!-- Paths from decision -->
                        <path d="M 221 346 L 260 385" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>
                        <text x="250" y="375" class="header-text">قبول</text>
                        <foreignObject x="225" y="385" width="100" height="70" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content">استيفاء الملف وإرساله للجهات المختصة</div>
                        </foreignObject>

                        <path d="M 179 346 L 140 385" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>
                        <text x="150" y="375" class="header-text">رفض</text>
                        <foreignObject x="75" y="385" width="100" height="70" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content">تقديم مذكرات وإخطار الموظف</div>
                        </foreignObject>
                        <path d="M 125 455 V 480" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>
                        <foreignObject x="75" y="480" width="100" height="50" class="flow-box" style="animation-delay: 2.0s;">
                            <div class="box-content">إعادة الفحص</div>
                        </foreignObject>

                        <!-- Merge and End -->
                        <path d="M 275 455 V 550 H 200" class="flow-line" style="animation-delay: 2.2s;"></path>
                        <path d="M 125 530 V 550 H 200" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.2s;"></path>
                        <foreignObject x="125" y="575" width="150" height="50" class="flow-box" style="animation-delay: 2.4s;">
                            <div class="box-content start-end">🏁 حفظ وأرشفة</div>
                        </foreignObject>
                    </svg>
                `,
                performanceGrievancesAnalysis: `
                    <svg viewBox="0 0 500 600" class="svg-flowchart" style="direction: rtl; min-height: 600px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="250" y="15" class="header-text" text-anchor="middle">مخطط تظلمات تقييم الأداء</text>

                        <!-- Swimlanes -->
                        <text x="425" y="40" class="header-text" text-anchor="middle">إدارة الموارد البشرية</text>
                        <line x1="350" y1="25" x2="350" y2="600" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>
                        
                        <text x="250" y="40" class="header-text" text-anchor="middle">الموظف المختص</text>
                        <line x1="150" y1="25" x2="150" y2="600" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="75" y="40" class="header-text" text-anchor="middle">السيد المحافظ</text>

                        <!-- Start -->
                        <foreignObject x="375" y="60" width="100" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 تشكيل لجنة التظلمات</div>
                        </foreignObject>
                        <path d="M 375 90 H 250" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Step 2: Employee -->
                        <foreignObject x="175" y="75" width="100" height="80" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">📋 تقديم طلب التظلم وإعداد جدول الأعمال</div>
                        </foreignObject>
                        <path d="M 225 155 V 180" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- Step 3: HR -->
                        <foreignObject x="175" y="180" width="100" height="60" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">إعداد محضر اجتماع اللجنة</div>
                        </foreignObject>
                        <path d="M 175 210 H 75" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>

                        <!-- Step 4: Governor -->
                        <foreignObject x="0" y="250" width="100" height="60" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">🏛️ اعتماد محضر اللجنة</div>
                        </foreignObject>

                        <!-- Timeline Note -->
                        <foreignObject x="25" y="320" width="100" height="60" class="flow-box" style="animation-delay: 1.4s; background-color: rgba(245, 158, 11, 0.1);">
                            <div class="box-content" style="border-color: var(--warning-color);">📅 البت خلال 60 يومًا</div>
                        </foreignObject>
                        <path d="M 50 310 V 320" class="flow-line" style="animation-delay: 1.3s;"></path>
                        <path d="M 50 380 V 400" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.5s;"></path>

                        <!-- Step 5: HR Notification -->
                         <path d="M 50 400 H 425" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.6s;"></path>
                        <foreignObject x="375" y="420" width="100" height="60" class="flow-box" style="animation-delay: 1.8s;">
                            <div class="box-content">📢 إخطار الموظف بالنتيجة</div>
                        </foreignObject>
                        <path d="M 425 480 V 505" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.0s;"></path>

                        <!-- End -->
                        <foreignObject x="375" y="505" width="100" height="50" class="flow-box" style="animation-delay: 2.2s;">
                            <div class="box-content start-end">🏁 النهاية</div>
                        </foreignObject>
                    </svg>
                `,
                employeeTransferAnalysis: `
                    <svg viewBox="0 0 800 650" class="svg-flowchart" style="direction: rtl; min-height: 650px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="400" y="15" class="header-text" text-anchor="middle">مخطط إجراءات نقل الموظفين</text>

                        <!-- Internal Transfer Path -->
                        <text x="650" y="40" class="header-text" text-anchor="middle">النقل الداخلي</text>
                        <foreignObject x="600" y="60" width="150" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 استلام طلب النقل الداخلي</div>
                        </foreignObject>
                        <path d="M 675 120 V 145" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>
                        <foreignObject x="600" y="145" width="150" height="60" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">إعداد تقرير الرئيس المباشر</div>
                        </foreignObject>
                        <path d="M 675 205 V 230" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>
                        <foreignObject x="600" y="230" width="150" height="60" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">العرض على السلطة المختصة</div>
                        </foreignObject>
                        <path d="M 675 290 V 315" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>
                        <g transform="translate(675, 345) rotate(45)" class="flow-box" style="animation-delay: 1.2s;">
                           <rect x="-25" y="-25" width="50" height="50" fill="#2c2a4a" stroke="var(--primary-accent)"></rect>
                           <text x="0" y="5" fill="var(--text-color)" transform="rotate(-45)" text-anchor="middle">القرار؟</text>
                        </g>
                        <path d="M 693 363 L 725 395" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>
                        <text x="715" y="385" class="header-text">قبول</text>
                        <foreignObject x="675" y="395" width="100" height="60" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content">استكمال الإجراءات وحفظ الملف</div>
                        </foreignObject>
                        <path d="M 657 363 L 625 395" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>
                        <text x="635" y="385" class="header-text">رفض</text>
                        <foreignObject x="575" y="395" width="100" height="60" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content start-end">🏁 إنهاء الموضوع</div>
                        </foreignObject>

                        <!-- Separator Line -->
                        <line x1="400" y1="25" x2="400" y2="650" stroke="var(--border-color)" stroke-width="2" stroke-dasharray="5,5"/>

                        <!-- External Transfer Path -->
                        <text x="150" y="40" class="header-text" text-anchor="middle">النقل الخارجي</text>
                        <foreignObject x="100" y="60" width="150" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 استلام طلب النقل الخارجي</div>
                        </foreignObject>
                        <path d="M 175 120 V 145" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>
                        <foreignObject x="100" y="145" width="150" height="60" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">العرض على اللجنة المختصة</div>
                        </foreignObject>
                        <path d="M 175 205 V 230" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>
                        <g transform="translate(175, 260) rotate(45)" class="flow-box" style="animation-delay: 0.8s;">
                           <rect x="-25" y="-25" width="50" height="50" fill="#2c2a4a" stroke="var(--primary-accent)"></rect>
                           <text x="0" y="5" fill="var(--text-color)" transform="rotate(-45)" text-anchor="middle">موافقة؟</text>
                        </g>
                        <path d="M 193 278 L 225 310" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>
                        <text x="215" y="300" class="header-text">نعم</text>
                        <foreignObject x="175" y="310" width="100" height="70" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">مخاطبة الجهة الأخرى</div>
                        </foreignObject>
                         <path d="M 157 278 L 125 310" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>
                        <text x="135" y="300" class="header-text">لا</text>
                        <foreignObject x="75" y="310" width="100" height="60" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content start-end">🏁 إنهاء الموضوع</div>
                        </foreignObject>
                        <path d="M 225 380 V 405" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>
                        <foreignObject x="100" y="405" width="150" height="80" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content">إرسال للجهاز المركزي ووزارة المالية</div>
                        </foreignObject>
                        <path d="M 175 485 V 510" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>
                        <foreignObject x="100" y="510" width="150" height="60" class="flow-box" style="animation-delay: 2.0s;">
                            <div class="box-content">إصدار القرار وتحديث الملفات</div>
                        </foreignObject>
                    </svg>
                `,
                employeeDeputationAnalysis: `
                    <svg viewBox="0 0 700 700" class="svg-flowchart" style="direction: rtl; min-height: 700px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="350" y="15" class="header-text" text-anchor="middle">مخطط إجراءات الندب</text>

                        <!-- Swimlanes -->
                        <text x="625" y="40" class="header-text" text-anchor="middle">كاتب أول / رئيس قسم</text>
                        <line x1="550" y1="25" x2="550" y2="700" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>
                        
                        <text x="450" y="40" class="header-text" text-anchor="middle">مدير الموارد البشرية</text>
                        <line x1="350" y1="25" x2="350" y2="700" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="250" y="40" class="header-text" text-anchor="middle">السكرتير العام</text>
                        <line x1="150" y1="25" x2="150" y2="700" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="75" y="40" class="header-text" text-anchor="middle">المحافظ</text>

                        <!-- Start -->
                        <foreignObject x="575" y="60" width="100" height="80" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 استلام طلب الندب ومراجعة المستندات (نموذج 1)</div>
                        </foreignObject>
                        <path d="M 575 100 H 450" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- HR Manager Review -->
                        <foreignObject x="375" y="80" width="100" height="70" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">مراجعة وإعداد إخطار (نموذج 2)</div>
                        </foreignObject>
                        <path d="M 375 115 H 250" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- General Secretary Review -->
                        <foreignObject x="175" y="150" width="100" height="60" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">مراجعة ورفع للمحافظ</div>
                        </foreignObject>
                        <path d="M 175 180 H 75" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>

                        <!-- Governor Approval -->
                        <foreignObject x="0" y="220" width="100" height="60" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">🏛️ اعتماد الطلب</div>
                        </foreignObject>
                        <path d="M 50 280 V 305" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>
                        <foreignObject x="0" y="305" width="100" height="60" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content">إصدار مشروع قرار (نموذج 3)</div>
                        </foreignObject>
                        <path d="M 50 365 V 390 H 450" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>

                        <!-- Final Decision -->
                        <foreignObject x="375" y="390" width="100" height="60" class="flow-box" style="animation-delay: 2.0s;">
                            <div class="box-content">إعداد قرار الندب (نموذج 4)</div>
                        </foreignObject>
                        <path d="M 425 450 V 475" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.2s;"></path>

                        <!-- Notifications & Archiving -->
                        <foreignObject x="375" y="475" width="100" height="120" class="flow-box" style="animation-delay: 2.4s;">
                             <div class="box-content" style="flex-direction:column; align-items:flex-start; text-align:right;">
                                <b>📨 إخطار وحفظ:</b>
                                <ul class="list-disc pr-4 text-xs">
                                    <li>إخطار الموظف (نموذج 5)</li>
                                    <li>إخطار الجهة (نموذج 8)</li>
                                    <li>حفظ في الملف</li>
                                </ul>
                            </div>
                        </foreignObject>
                        <path d="M 425 595 V 620" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.6s;"></path>
                        
                        <!-- End -->
                        <foreignObject x="375" y="620" width="100" height="50" class="flow-box" style="animation-delay: 2.8s;">
                            <div class="box-content start-end">🏁 النهاية</div>
                        </foreignObject>
                    </svg>
                `,
                settlementAnalysis: `
                    <svg viewBox="0 0 600 700" class="svg-flowchart" style="direction: rtl; min-height: 700px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="300" y="15" class="header-text" text-anchor="middle">مخطط إجراءات التسويات</text>

                        <!-- Swimlanes -->
                        <text x="525" y="40" class="header-text" text-anchor="middle">مسؤول الخدمة المدنية</text>
                        <line x1="450" y1="25" x2="450" y2="700" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>
                        
                        <text x="350" y="40" class="header-text" text-anchor="middle">لجنة الموارد البشرية</text>
                        <line x1="250" y1="25" x2="250" y2="700" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="175" y="40" class="header-text" text-anchor="middle">الإدارة المالية</text>
                        <line x1="100" y1="25" x2="100" y2="700" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="50" y="40" class="header-text" text-anchor="middle">الجهاز المركزي</text>

                        <!-- Start -->
                        <foreignObject x="475" y="60" width="100" height="80" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 استلام طلب التسوية ومراجعة المستندات</div>
                        </foreignObject>
                        <path d="M 525 140 V 165" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>
                        <foreignObject x="475" y="165" width="100" height="60" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">إعداد مذكرة وعرضها على اللجنة</div>
                        </foreignObject>
                        <path d="M 475 195 H 350" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- Step 2: HR Committee -->
                        <foreignObject x="275" y="175" width="100" height="70" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">📋 مراجعة الطلب وإصدار القرار</div>
                        </foreignObject>
                        <path d="M 275 210 H 200" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>
                        <path d="M 275 210 H 50" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>

                        <!-- Step 3: Finance Dept -->
                        <foreignObject x="125" y="270" width="100" height="60" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">💵 مراجعة مالية</div>
                        </foreignObject>

                        <!-- Step 4: Central Org -->
                        <foreignObject x="0" y="270" width="100" height="60" class="flow-box" style="animation-delay: 1.4s;">
                            <div class="box-content">🏛️ دراسة الطلب</div>
                        </foreignObject>

                        <!-- Decision Point -->
                        <g transform="translate(175, 380) rotate(45)" class="flow-box" style="animation-delay: 1.6s;">
                           <rect x="-30" y="-30" width="60" height="60" fill="#2c2a4a" stroke="var(--primary-accent)"></rect>
                           <text x="0" y="5" fill="var(--text-color)" transform="rotate(-45)" text-anchor="middle">مردود مالي؟</text>
                        </g>
                        <path d="M 175 330 V 359" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.5s;"></path>
                        <path d="M 50 330 V 450 H 175" class="flow-line" style="animation-delay: 1.7s;"></path>

                        <!-- Paths from decision -->
                        <path d="M 196 401 L 225 430" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>
                        <text x="220" y="420" class="header-text">نعم</text>
                        <foreignObject x="225" y="430" width="100" height="70" class="flow-box" style="animation-delay: 2.0s;">
                            <div class="box-content">رفع للجهاز المركزي ووزارة المالية</div>
                        </foreignObject>

                        <path d="M 154 401 L 125 430" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>
                        <text x="130" y="420" class="header-text">لا</text>
                        <foreignObject x="25" y="450" width="100" height="60" class="flow-box" style="animation-delay: 2.2s;">
                            <div class="box-content">إصدار قرار نهائي</div>
                        </foreignObject>
                        <path d="M 75 510 V 535" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.4s;"></path>
                        <path d="M 275 500 V 535" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.4s;"></path>

                        <!-- End -->
                        <foreignObject x="25" y="535" width="300" height="50" class="flow-box" style="animation-delay: 2.6s;">
                            <div class="box-content start-end">🏁 اعتماد على النظام وأرشفة</div>
                        </foreignObject>
                    </svg>
                `,
                promotionAnalysis: `
                    <svg viewBox="0 0 500 650" class="svg-flowchart" style="direction: rtl; min-height: 650px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="250" y="15" class="header-text" text-anchor="middle">مخطط إجراءات الترقيات</text>

                        <!-- Swimlanes -->
                        <text x="425" y="40" class="header-text" text-anchor="middle">الموظف المختص</text>
                        <line x1="350" y1="25" x2="350" y2="650" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>
                        
                        <text x="250" y="40" class="header-text" text-anchor="middle">لجنة الموارد البشرية</text>
                        <line x1="150" y1="25" x2="150" y2="650" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="75" y="40" class="header-text" text-anchor="middle">السلطة المختصة</text>

                        <!-- Start -->
                        <foreignObject x="375" y="60" width="100" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 إعداد كشوف الترقية</div>
                        </foreignObject>
                        <path d="M 375 90 H 250" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Step 2: HR Committee Review -->
                        <foreignObject x="175" y="140" width="100" height="70" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">📋 عرض الكشوف على اللجنة</div>
                        </foreignObject>
                        <path d="M 175 175 H 75" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- Step 3 & 4: Authority Approval -->
                        <foreignObject x="0" y="220" width="100" height="70" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">📤 رفع التوصيات للاعتماد</div>
                        </foreignObject>
                        <path d="M 50 290 V 315" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>
                        <foreignObject x="0" y="315" width="100" height="60" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">🏛️ إصدار قرار الترقية</div>
                        </foreignObject>
                        <path d="M 50 375 V 400 H 425" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>

                        <!-- Step 5: Notify Employees -->
                        <foreignObject x="375" y="400" width="100" height="60" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content">📢 إخطار الموظفين بالترقية</div>
                        </foreignObject>
                        <path d="M 425 460 V 485" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>

                        <!-- Step 6: Archive -->
                        <foreignObject x="375" y="485" width="100" height="60" class="flow-box" style="animation-delay: 2.0s;">
                            <div class="box-content start-end">📂 حفظ القرارات</div>
                        </foreignObject>
                    </svg>
                `,
                serviceTerminationAnalysis: `
                    <svg viewBox="0 0 500 600" class="svg-flowchart" style="direction: rtl; min-height: 600px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="250" y="15" class="header-text" text-anchor="middle">مخطط إجراءات إنهاء الخدمة</text>

                        <!-- Swimlanes -->
                        <text x="425" y="40" class="header-text" text-anchor="middle">مسؤول التعيينات</text>
                        <line x1="350" y1="25" x2="350" y2="600" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>
                        
                        <text x="250" y="40" class="header-text" text-anchor="middle">مدير الموارد البشرية</text>
                        <line x1="150" y1="25" x2="150" y2="600" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="75" y="40" class="header-text" text-anchor="middle">السلطة العليا</text>

                        <!-- Start -->
                        <foreignObject x="375" y="60" width="100" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 استلام قرار إنهاء الخدمة</div>
                        </foreignObject>
                        <path d="M 425 120 V 145" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Step 2: Prepare Letters -->
                        <foreignObject x="375" y="145" width="100" height="80" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">📄 تجهيز خطاب إيقاف المستحقات</div>
                        </foreignObject>
                        <path d="M 375 185 H 250" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- Step 3: Review & Approval -->
                        <foreignObject x="175" y="240" width="100" height="70" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">📝 مراجعة واعتماد الخطاب</div>
                        </foreignObject>
                        <path d="M 175 275 H 75" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>
                        <foreignObject x="0" y="320" width="100" height="70" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">إصدار قرار صرف المستحقات</div>
                        </foreignObject>
                        <path d="M 50 390 V 415 H 425" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>

                        <!-- Step 4 & 5: Distribute & Archive -->
                        <foreignObject x="375" y="415" width="100" height="120" class="flow-box" style="animation-delay: 1.6s;">
                             <div class="box-content" style="flex-direction:column; align-items:flex-start; text-align:right;">
                                <b>📬 توزيع وحفظ:</b>
                                <ul class="list-disc pr-4 text-xs">
                                    <li>توزيع القرارات</li>
                                    <li>أرشفة في ملف إنهاء الخدمة</li>
                                </ul>
                            </div>
                        </foreignObject>
                        <path d="M 425 535 V 550" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>
                        
                        <!-- End -->
                        <foreignObject x="375" y="550" width="100" height="40" class="flow-box" style="animation-delay: 2.0s;">
                            <div class="box-content start-end">🏁 النهاية</div>
                        </foreignObject>
                    </svg>
                `,
                employeeHiringAnalysis: `
                    <svg viewBox="0 0 800 600" class="svg-flowchart" style="direction: rtl; min-height: 600px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="400" y="15" class="header-text" text-anchor="middle">مخطط إجراءات تعيين القوى العاملة</text>

                        <!-- Swimlanes -->
                        <text x="725" y="40" class="header-text" text-anchor="middle">القوى العاملة</text>
                        <line x1="650" y1="25" x2="650" y2="600" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>
                        
                        <text x="525" y="40" class="header-text" text-anchor="middle">رئيس قسم التعيينات</text>
                        <line x1="400" y1="25" x2="400" y2="600" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="325" y="40" class="header-text" text-anchor="middle">الموظف المعين</text>
                        <line x1="250" y1="25" x2="250" y2="600" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="175" y="40" class="header-text" text-anchor="middle">قسم الملفات</text>
                        <line x1="100" y1="25" x2="100" y2="600" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="50" y="40" class="header-text" text-anchor="middle">قسم الاستحقاقات</text>
                        
                        <!-- Start -->
                        <foreignObject x="675" y="60" width="100" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 إصدار قرار التعيين</div>
                        </foreignObject>
                        <path d="M 675 90 H 525" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Step 2: Appointments Dept -->
                        <foreignObject x="425" y="75" width="100" height="150" class="flow-box" style="animation-delay: 0.4s;">
                             <div class="box-content" style="flex-direction:column; align-items:flex-start; text-align:right;">
                                <b>📄 استلام القرار:</b>
                                <ul class="list-disc pr-4 text-xs">
                                    <li>تحرير استمارة 103</li>
                                    <li>تحرير خطاب استلام العمل</li>
                                    <li>استلام صورة القرار</li>
                                </ul>
                            </div>
                        </foreignObject>
                        <path d="M 425 150 H 350" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>
                        
                        <!-- Step 3: New Employee -->
                        <foreignObject x="275" y="200" width="100" height="80" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">🧑‍💼 استيفاء مصوغات التعيين واستلام العمل</div>
                        </foreignObject>
                        <path d="M 325 280 V 320 H 475" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>

                        <!-- Back to Appointments Dept -->
                        <foreignObject x="425" y="320" width="100" height="60" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">تجميع الملف الشخصي</div>
                        </foreignObject>
                        <path d="M 425 350 H 200" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>
                        <path d="M 525 225 V 400 H 50" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.5s;"></path>

                        <!-- Step 4: Files Dept -->
                        <foreignObject x="125" y="320" width="100" height="80" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content">🗂️ استلام الملف، التأكد من البيانات، والحفظ</div>
                        </foreignObject>

                        <!-- Step 5: Benefits Dept -->
                        <foreignObject x="0" y="400" width="100" height="70" class="flow-box" style="animation-delay: 1.8s;">
                            <div class="box-content">📊 استلام صورة القرار وإدخال بيانات المرتب</div>
                        </foreignObject>
                        <path d="M 175 400 V 480" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.0s;"></path>

                        <!-- End -->
                        <foreignObject x="125" y="480" width="100" height="50" class="flow-box" style="animation-delay: 2.2s;">
                            <div class="box-content start-end">🏁 النهاية</div>
                        </foreignObject>
                    </svg>
                `,
                performanceAppraisalAnalysis: `
                    <svg viewBox="0 0 600 650" class="svg-flowchart" style="direction: rtl; min-height: 650px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="300" y="15" class="header-text" text-anchor="middle">مخطط إجراء تقييم الأداء</text>

                        <!-- Swimlanes -->
                        <text x="525" y="40" class="header-text" text-anchor="middle">الموظف المختص</text>
                        <line x1="450" y1="25" x2="450" y2="650" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>
                        
                        <text x="350" y="40" class="header-text" text-anchor="middle">إدارة الموارد البشرية</text>
                        <line x1="250" y1="25" x2="250" y2="650" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="175" y="40" class="header-text" text-anchor="middle">الرئيس المباشر</text>
                        <line x1="100" y1="25" x2="100" y2="650" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="50" y="40" class="header-text" text-anchor="middle">الرئيس الأعلى</text>

                        <!-- Step 1: Preparation -->
                        <foreignObject x="475" y="60" width="100" height="70" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 إعداد خطة ونماذج التقييم</div>
                        </foreignObject>
                        <path d="M 525 130 V 155" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Step 2: Data Collection -->
                        <path d="M 525 155 H 350" class="flow-line" style="animation-delay: 0.4s;"></path>
                        <foreignObject x="275" y="155" width="150" height="70" class="flow-box" style="animation-delay: 0.6s;">
                            <div class="box-content">📥 استلام وتجميع البيانات وإرسال النماذج</div>
                        </foreignObject>
                        <path d="M 275 190 H 200" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.8s;"></path>

                        <!-- Step 3: Approval -->
                        <foreignObject x="125" y="240" width="100" height="60" class="flow-box" style="animation-delay: 1.0s;">
                            <div class="box-content">✅ اعتماد التقرير الأولي</div>
                        </foreignObject>
                        <path d="M 125 270 H 50" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.2s;"></path>
                        <foreignObject x="0" y="320" width="100" height="60" class="flow-box" style="animation-delay: 1.4s;">
                            <div class="box-content">✅ اعتماد التقرير النهائي</div>
                        </foreignObject>
                        <path d="M 50 380 V 405 H 350" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.6s;"></path>

                        <!-- Step 4: Printing & Documentation -->
                        <foreignObject x="275" y="405" width="150" height="120" class="flow-box" style="animation-delay: 1.8s;">
                            <div class="box-content" style="flex-direction:column; align-items:flex-start; text-align:right;">
                                <b>🖨️ طباعة وتوثيق:</b>
                                <ul class="list-disc pr-4 text-xs">
                                    <li>عرض على لجنة الموارد البشرية</li>
                                    <li>تسجيل في قاعدة البيانات</li>
                                    <li>إرسال نسخة للموظف</li>
                                </ul>
                            </div>
                        </foreignObject>
                        <path d="M 350 525 V 550" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.0s;"></path>
                        
                        <!-- End -->
                        <foreignObject x="300" y="550" width="100" height="50" class="flow-box" style="animation-delay: 2.2s;">
                            <div class="box-content start-end">🏁 النهاية</div>
                        </foreignObject>
                    </svg>
                `,
                allowancesAnalysis: `
                    <svg viewBox="0 0 700 700" class="svg-flowchart" style="direction: rtl; min-height: 700px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="350" y="15" class="header-text" text-anchor="middle">مخطط إجراء العلاوات الدورية والتشجيعية</text>

                        <!-- Swimlanes -->
                        <text x="625" y="40" class="header-text" text-anchor="middle">كاتب أول</text>
                        <line x1="550" y1="25" x2="550" y2="700" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>
                        
                        <text x="475" y="40" class="header-text" text-anchor="middle">رئيس القسم</text>
                        <line x1="400" y1="25" x2="400" y2="700" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="325" y="40" class="header-text" text-anchor="middle">مدير الموارد البشرية</text>
                        <line x1="250" y1="25" x2="250" y2="700" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="175" y="40" class="header-text" text-anchor="middle">السكرتير العام</text>
                        <line x1="100" y1="25" x2="100" y2="700" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="50" y="40" class="header-text" text-anchor="middle">المحافظ</text>

                        <!-- Step 1: Start & Preparation -->
                        <foreignObject x="575" y="60" width="100" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 قرار وزاري بالعلاوة</div>
                        </foreignObject>
                        <path d="M 625 120 V 145" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>
                        <foreignObject x="565" y="145" width="120" height="80" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">إعداد البيانات وحساب الاستحقاقات</div>
                        </foreignObject>
                        <path d="M 565 185 H 500" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- Step 2: Reviews -->
                        <foreignObject x="425" y="160" width="75" height="50" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">مراجعة</div>
                        </foreignObject>
                        <path d="M 425 185 H 350" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>
                        <foreignObject x="275" y="160" width="75" height="50" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">مراجعة</div>
                        </foreignObject>
                        <path d="M 275 185 H 200" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>
                        <foreignObject x="125" y="160" width="75" height="50" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content">مراجعة</div>
                        </foreignObject>
                        <path d="M 125 185 H 50" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>
                        <foreignObject x="0" y="160" width="75" height="50" class="flow-box" style="animation-delay: 2.0s;">
                            <div class="box-content">اعتماد</div>
                        </foreignObject>
                        
                        <!-- Step 3: Financial Impact Decision -->
                        <path d="M 37.5 210 V 280" class="flow-line" style="animation-delay: 2.2s;"></path>
                        <g transform="translate(37.5, 300) rotate(45)" class="flow-box" style="animation-delay: 2.4s;">
                           <rect x="-30" y="-30" width="60" height="60" fill="#2c2a4a" stroke="var(--primary-accent)"></rect>
                           <text x="0" y="5" fill="var(--text-color)" transform="rotate(-45)" text-anchor="middle">أثر مالي؟</text>
                        </g>

                        <!-- Paths from decision -->
                        <path d="M 37.5 321 V 400" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.6s;"></path>
                        <text x="50" y="360" class="header-text">نعم</text>
                        <path d="M 58 300 H 150" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.6s;"></path>
                        <text x="100" y="295" class="header-text">لا</text>

                        <!-- Step 4: Execution -->
                        <foreignObject x="0" y="400" width="75" height="70" class="flow-box" style="animation-delay: 2.8s;">
                            <div class="box-content">مراجعة مالية إضافية</div>
                        </foreignObject>
                         <path d="M 37.5 470 V 490 H 150" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 3.0s;"></path>

                        <foreignObject x="150" y="490" width="150" height="60" class="flow-box" style="animation-delay: 3.2s;">
                            <div class="box-content">إرسال التعليمات للتنفيذ (شؤون مالية / أقسام)</div>
                        </foreignObject>
                        <path d="M 225 550 V 575" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 3.4s;"></path>

                        <!-- Step 5: Archive -->
                        <foreignObject x="175" y="575" width="100" height="50" class="flow-box" style="animation-delay: 3.6s;">
                            <div class="box-content start-end">🏁 حفظ وأرشفة</div>
                        </foreignObject>
                    </svg>
                `,
                penaltiesGrievancesAnalysis: `
                    <svg viewBox="0 0 600 650" class="svg-flowchart" style="direction: rtl; min-height: 650px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="300" y="15" class="header-text" text-anchor="middle">مخطط التظلم من التقارير</text>

                        <!-- Swimlanes -->
                        <text x="525" y="40" class="header-text" text-anchor="middle">الموظف المختص</text>
                        <line x1="450" y1="25" x2="450" y2="650" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>
                        
                        <text x="350" y="40" class="header-text" text-anchor="middle">إدارة الموارد البشرية</text>
                        <line x1="250" y1="25" x2="250" y2="650" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="175" y="40" class="header-text" text-anchor="middle">لجنة التظلمات</text>
                        <line x1="100" y1="25" x2="100" y2="650" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="50" y="40" class="header-text" text-anchor="middle">السيد المحافظ</text>

                        <!-- Step 1: Start -->
                        <foreignObject x="300" y="60" width="100" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 بدء الإجراء (تشكيل لجنة)</div>
                        </foreignObject>
                        <path d="M 350 120 V 145" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>
                        <path d="M 350 120 H 480" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Step 2: Employee submits -->
                        <foreignObject x="480" y="145" width="100" height="70" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">📝 تقديم نموذج التظلم</div>
                        </foreignObject>
                        <path d="M 480 215 V 240 H 300" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>
                        <path d="M 480 180 H 200" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- Step 3: Committee meeting -->
                        <foreignObject x="125" y="240" width="100" height="60" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">🧾 عمل محضر اجتماع اللجنة</div>
                        </foreignObject>
                        
                        <!-- Step 4: Time limit -->
                        <foreignObject x="125" y="320" width="100" height="60" class="flow-box" style="animation-delay: 1.0s; background-color: rgba(245, 158, 11, 0.1);">
                            <div class="box-content" style="border-color: var(--warning-color);">📅 البت في التظلم (خلال 60 يوم)</div>
                        </foreignObject>
                         <path d="M 175 300 V 320" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.9s;"></path>
                         <path d="M 175 380 V 400" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.1s;"></path>

                        <!-- Step 5: Governor's decision -->
                        <path d="M 175 400 H 50" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.2s;"></path>
                        <foreignObject x="0" y="400" width="100" height="60" class="flow-box" style="animation-delay: 1.4s;">
                            <div class="box-content">🧑‍💼 اعتماد المحضر وإصدار القرار</div>
                        </foreignObject>
                        <path d="M 50 460 V 485 H 350" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.6s;"></path>

                        <!-- Step 6: Inform Employee -->
                        <foreignObject x="300" y="485" width="100" height="50" class="flow-box" style="animation-delay: 1.8s;">
                            <div class="box-content">📢 إبلاغ الموظف بالقرار</div>
                        </foreignObject>
                        <path d="M 350 535 V 560" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.0s;"></path>

                        <!-- End -->
                        <foreignObject x="300" y="560" width="100" height="50" class="flow-box" style="animation-delay: 2.2s;">
                            <div class="box-content start-end">🏁 النهاية</div>
                        </foreignObject>
                    </svg>
                `,
                solidarityFundAnalysis: `
                    <svg viewBox="0 0 500 550" class="svg-flowchart" style="direction: rtl; min-height: 550px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="250" y="15" class="header-text" text-anchor="middle">مخطط صرف مستحقات صندوق التكافل</text>

                        <!-- Swimlanes -->
                        <text x="400" y="40" class="header-text" text-anchor="middle">مسؤول قسم التكافل</text>
                        <line x1="300" y1="25" x2="300" y2="550" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>
                        
                        <text x="200" y="40" class="header-text" text-anchor="middle">مدير الموارد البشرية</text>
                        <line x1="100" y1="25" x2="100" y2="550" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="50" y="40" class="header-text" text-anchor="middle">قسم الحسابات</text>

                        <!-- Start -->
                        <foreignObject x="350" y="60" width="100" height="50" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 بدء الإجراء</div>
                        </foreignObject>
                        <path d="M 400 110 V 135" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Step 2 -->
                        <foreignObject x="325" y="135" width="150" height="70" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">📝 إعداد مذكرة الصرف + استمارة 50</div>
                        </foreignObject>
                        <path d="M 325 170 H 250" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- Step 3 -->
                        <foreignObject x="150" y="220" width="100" height="70" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">✅ اعتماد المذكرة والاستمارة</div>
                        </foreignObject>
                        <path d="M 150 255 H 75" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>

                        <!-- Step 4 -->
                        <foreignObject x="0" y="300" width="100" height="50" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">💵 صرف المبلغ</div>
                        </foreignObject>
                        <path d="M 50 350 V 375" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>

                         <!-- End -->
                        <foreignObject x="0" y="375" width="100" height="50" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content start-end">🏁 إنهاء الإجراء</div>
                        </foreignObject>
                    </svg>
                `,
                workInjuryAnalysis: `
                    <svg viewBox="0 0 500 700" class="svg-flowchart" style="direction: rtl; min-height: 700px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="250" y="15" class="header-text" text-anchor="middle">مخطط إجراء إصابة عمل</text>

                        <!-- Swimlanes -->
                        <text x="425" y="40" class="header-text" text-anchor="middle">الموظف المعني</text>
                        <line x1="350" y1="25" x2="350" y2="700" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>
                        
                        <text x="250" y="40" class="header-text" text-anchor="middle">العيادة الطبية</text>
                        <line x1="150" y1="25" x2="150" y2="700" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="75" y="40" class="header-text" text-anchor="middle">الموارد البشرية</text>

                        <!-- Start -->
                        <foreignObject x="375" y="60" width="100" height="50" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 بدء الإجراء (إصابة)</div>
                        </foreignObject>
                        <path d="M 425 110 V 135" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Step 1 -->
                        <foreignObject x="365" y="135" width="120" height="50" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">التوجه للمستشفى وإدخال البيانات</div>
                        </foreignObject>
                        <path d="M 365 160 H 320" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- Step 2 (Clinic) -->
                        <foreignObject x="200" y="135" width="120" height="70" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">تحرير تقرير طبي (نموذج 1) وإصدار قرار إصابة (نموذج 2)</div>
                        </foreignObject>
                        <path d="M 200 170 H 120" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>
                        
                        <!-- Step 3 (HR) -->
                        <foreignObject x="15" y="220" width="120" height="70" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">إعداد عرض طبي (نموذج 3)</div>
                        </foreignObject>
                        <path d="M 75 290 V 315" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>
                        
                        <!-- Step 4 (HR) -->
                        <foreignObject x="15" y="315" width="120" height="70" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content">إعداد بيان مدة الإجازة (نموذج 4)</div>
                        </foreignObject>
                        <path d="M 75 385 V 410" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>

                        <!-- Step 5 (HR) -->
                        <foreignObject x="15" y="410" width="120" height="70" class="flow-box" style="animation-delay: 2.0s;">
                            <div class="box-content">إصدار أمر إداري بالإجازة (نموذج 5-أ)</div>
                        </foreignObject>
                        <path d="M 75 480 V 505" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.2s;"></path>

                        <!-- Step 6 (Delivery) -->
                        <foreignObject x="15" y="505" width="450" height="80" class="flow-box" style="animation-delay: 2.4s;">
                            <div class="box-content" style="flex-direction: column; align-items: flex-start; text-align: right; padding: 0.5rem;">
                                <b>🏥 تسليم وتوثيق:</b>
                                <ul class="list-disc pr-4 text-xs">
                                    <li>نسخ إلى: الحسابات, مكتب الصحة, قسم المتابعة</li>
                                    <li>أصل البيان وصورة القرار للموظف</li>
                                </ul>
                            </div>
                        </foreignObject>
                        <path d="M 250 585 V 610" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.6s;"></path>

                        <!-- End -->
                        <foreignObject x="200" y="610" width="100" height="40" class="flow-box" style="animation-delay: 2.8s;">
                            <div class="box-content start-end">🏁 النهاية</div>
                        </foreignObject>
                    </svg>
                `,
                leaveProcessAnalysis: `
                    <svg viewBox="0 0 450 550" class="svg-flowchart" style="direction: rtl; min-height: 550px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)" />
                            </marker>
                        </defs>
                        <text x="225" y="15" class="header-text" text-anchor="middle">مخطط إدخال الإجازات</text>

                        <!-- Swimlanes -->
                        <text x="370" y="40" class="header-text" text-anchor="middle">مسؤول الإجازات</text>
                        <line x1="300" y1="25" x2="300" y2="550" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"/>
                        
                        <text x="200" y="40" class="header-text" text-anchor="middle">مسؤول الحاسب الآلي</text>
                        <line x1="100" y1="25" x2="100" y2="550" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"/>

                        <text x="50" y="40" class="header-text" text-anchor="middle">رئيس القسم</text>

                        <!-- Start -->
                        <foreignObject x="325" y="60" width="100" height="40" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 البداية</div>
                        </foreignObject>
                        <path d="M 375 100 V 125" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Step 1 -->
                        <foreignObject x="315" y="125" width="120" height="50" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">1. استلام الإجازات</div>
                        </foreignObject>
                        <path d="M 375 175 V 200" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- Step 2 -->
                        <foreignObject x="315" y="200" width="120" height="50" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">2. تسجيل أرقام الطلبات</div>
                        </foreignObject>
                        <path d="M 375 250 V 275" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1s;"></path>

                        <!-- Step 3 -->
                        <foreignObject x="315" y="275" width="120" height="50" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">3. إدخال الإجازات بالنظام</div>
                        </foreignObject>
                        <path d="M 315 300 H 260" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>
                        
                        <!-- Step 4 -->
                        <foreignObject x="140" y="275" width="120" height="70" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content">4. مراجعة وتسجيل الحاسب الآلي</div>
                        </foreignObject>
                        <path d="M 140 300 H 100 V 380 H 50" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>

                        <!-- Step 5 -->
                        <foreignObject x="-10" y="380" width="120" height="50" class="flow-box" style="animation-delay: 2s;">
                            <div class="box-content">5. مراجعة رئيس القسم</div>
                        </foreignObject>
                        <path d="M 50 430 V 455" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.2s;"></path>

                        <!-- End -->
                        <foreignObject x="0" y="455" width="100" height="40" class="flow-box" style="animation-delay: 2.4s;">
                            <div class="box-content start-end">🏁 النهاية</div>
                        </foreignObject>
                    </svg>
                `,
                trainingAnalysisFlowchart: `
                    <svg viewBox="0 0 400 650" class="svg-flowchart" style="direction: rtl; min-height: 650px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)" />
                            </marker>
                        </defs>
                        <text x="200" y="15" class="header-text" text-anchor="middle">مخطط تحليل إجراء التدريب</text>

                        <!-- Start -->
                        <foreignObject x="125" y="40" width="150" height="50" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 إعداد الخطة التدريبية</div>
                        </foreignObject>
                        <path d="M 200 90 V 115" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Step 2 -->
                        <foreignObject x="125" y="115" width="150" height="60" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">✅ الموافقة الإدارية<br><small>(إصدار نموذج 1)</small></div>
                        </foreignObject>
                        <path d="M 200 175 V 200" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- Step 3 -->
                        <foreignObject x="125" y="200" width="150" height="50" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">✉️ مخاطبة الجهات</div>
                        </foreignObject>
                        <path d="M 200 250 V 275" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1s;"></path>

                        <!-- Step 4 -->
                        <foreignObject x="125" y="275" width="150" height="50" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">📩 استقبال الترشيحات</div>
                        </foreignObject>
                        <path d="M 200 325 V 350" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>

                        <!-- Step 5 -->
                        <foreignObject x="125" y="350" width="150" height="70" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content">📋 إعداد كشف الأسماء</div>
                        </foreignObject>
                         <path d="M 200 420 V 445" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>

                        <!-- Step 6 -->
                        <foreignObject x="125" y="445" width="150" height="60" class="flow-box" style="animation-delay: 2s;">
                            <div class="box-content">🧾 تقييم النتائج<br><small>(إصدار نموذج 2)</small></div>
                        </foreignObject>
                        <path d="M 200 505 V 530" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.2s;"></path>

                        <!-- End -->
                        <foreignObject x="125" y="530" width="150" height="50" class="flow-box" style="animation-delay: 2.4s;">
                            <div class="box-content start-end">✅ إنهاء الدورة</div>
                        </foreignObject>
                    </svg>
                `,
                professionalDevProcess: `
                    <svg viewBox="0 0 400 550" class="svg-flowchart" style="direction: rtl;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)" />
                            </marker>
                        </defs>
                        
                        <line x1="100" y1="25" x2="250" y2="25" stroke="var(--border-color)" stroke-width="2" />
                        <text x="250" y="15" class="header-text"> استحداث تقسيمات تنظيمية</text>

                        <!-- Start -->
                        <foreignObject x="150" y="40" width="100" height="40" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">البداية</div>
                        </foreignObject>
                        
                        <!-- Path from Start -->
                        <path d="M 200 80 V 105" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Row 2 -->
                        <foreignObject x="25" y="105" width="150" height="60" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">قرار من رئيس الجمهورية، مجلس الوزراء / قرار السلطة المختصة</div>
                        </foreignObject>
                        <foreignObject x="225" y="105" width="150" height="60" class="flow-box" style="animation-delay: 0.6s;">
                            <div class="box-content">مقترح من الموارد البشرية</div>
                        </foreignObject>
                        
                        <!-- Path from HR -->
                        <path d="M 300 165 V 190" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.8s;"></path>

                        <!-- Row 3 -->
                         <foreignObject x="225" y="190" width="150" height="50" class="flow-box" style="animation-delay: 1s;">
                            <div class="box-content">اعتماد مقترح الادارة</div>
                        </foreignObject>

                        <!-- Path from Authority -->
                        <path d="M 100 165 V 265" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.2s;"></path>
                        
                        <!-- Row 4 -->
                        <foreignObject x="25" y="265" width="150" height="50" class="flow-box" style="animation-delay: 1.4s;">
                            <div class="box-content">اعتماد السيد المحافظ للقرار</div>
                        </foreignObject>

                        <!-- Connecting Paths -->
                        <path d="M 300 240 V 340 H 200" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.6s;"></path>
                        <path d="M 100 315 V 340 H 200" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>

                        <!-- Row 5 -->
                        <foreignObject x="125" y="365" width="150" height="50" class="flow-box" style="animation-delay: 2s;">
                            <div class="box-content">تنفيذ القرار من الموارد البشرية</div>
                        </foreignObject>

                        <!-- Path to End -->
                        <path d="M 200 415 V 440" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.2s;"></path>

                        <!-- End -->
                        <foreignObject x="150" y="440" width="100" height="40" class="flow-box" style="animation-delay: 2.4s;">
                            <div class="box-content start-end">النهاية</div>
                        </foreignObject>
                    </svg>
                `,
                settlementErd: `
                    <svg viewBox="0 0 400 300" class="svg-flowchart" style="direction: ltr; min-height: 300px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="8" refY="5" orient="auto">
                                <line x1="0" y1="0" x2="0" y2="10" stroke="var(--warning-color)" stroke-width="2"/>
                            </marker>
                        </defs>
                        <!-- Main Table -->
                        <foreignObject x="50" y="20" width="300" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content"><b>PAR_SettlementAcademicQualification</b><hr class="my-1 border-slate-500"/>Worker (RecId)<br/>PositionRecId (RecId)</div>
                        </foreignObject>
                        
                        <!-- Bottom Tables -->
                        <foreignObject x="25" y="220" width="150" height="50" class="flow-box" style="animation-delay: 0.2s;">
                            <div class="box-content"><b>HcmWorker</b><hr class="my-1 border-slate-500"/>RecId</div>
                        </foreignObject>
                        <foreignObject x="225" y="220" width="150" height="50" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content"><b>HcmPosition</b><hr class="my-1 border-slate-500"/>RecId</div>
                        </foreignObject>

                        <!-- Connectors -->
                        <path d="M 125 80 V 150" class="flow-line" style="animation-delay: 0.6s;"></path>
                        <path d="M 275 80 V 150" class="flow-line" style="animation-delay: 0.8s;"></path>
                        
                        <path d="M 125 150 L 100 150" class="flow-line" style="animation-delay: 1s;"></path>
                        <path d="M 275 150 L 300 150" class="flow-line" style="animation-delay: 1.2s;"></path>

                        <path d="M 100 150 V 220" class="flow-line" marker-end="url(#erd-line-end)" style="animation-delay: 1.4s;"></path>
                        <path d="M 300 150 V 220" class="flow-line" marker-end="url(#erd-line-end)" style="animation-delay: 1.6s;"></path>
                        
                        <!-- Diamonds -->
                        <g transform="translate(125, 150) rotate(45)" class="flow-box" style="animation-delay: 0.6s;">
                           <rect x="-15" y="-15" width="30" height="30" fill="#2c2a4a" stroke="var(--primary-accent)" />
                        </g>
                         <g transform="translate(275, 150) rotate(45)" class="flow-box" style="animation-delay: 0.8s;">
                           <rect x="-15" y="-15" width="30" height="30" fill="#2c2a4a" stroke="var(--primary-accent)" />
                        </g>
                    </svg>
                `,
                orgDevErd: `
                    <svg viewBox="0 0 400 400" class="svg-flowchart" style="direction: ltr; min-height: 400px;">
                        <!-- Entities -->
                        <foreignObject x="25" y="20" width="150" height="80" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content"><b>Departments</b><hr class="my-1 border-slate-500"/>DeptID (PK)<br/>DeptName</div>
                        </foreignObject>
                        <foreignObject x="225" y="20" width="150" height="80" class="flow-box" style="animation-delay: 0.2s;">
                            <div class="box-content"><b>Jobs</b><hr class="my-1 border-slate-500"/>JobID (PK)<br/>JobTitle</div>
                        </foreignObject>
                        <foreignObject x="25" y="160" width="150" height="80" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content"><b>Positions</b><hr class="my-1 border-slate-500"/>PositionID (PK)<br/>DeptID (FK)<br/>JobID (FK)</div>
                        </foreignObject>
                        <foreignObject x="225" y="160" width="150" height="80" class="flow-box" style="animation-delay: 0.6s;">
                            <div class="box-content"><b>Employees</b><hr class="my-1 border-slate-500"/>EmployeeID (PK)<br/>Name<br/>PositionID (FK)</div>
                        </foreignObject>

                        <!-- Relationships -->
                        <path d="M 100 100 V 160" class="flow-line" style="animation-delay: 0.8s;"></path>
                        <text x="105" y="135" fill="var(--text-color)">has (1..*)</text>
                        
                        <path d="M 225 60 H 175 V 160" class="flow-line" style="animation-delay: 1s;"></path>
                        <text x="180" y="55" fill="var(--text-color)">is instance of (1..*)</text>

                        <path d="M 175 200 H 225" class="flow-line" style="animation-delay: 1.2s;"></path>
                        <text x="180" y="195" fill="var(--text-color)">occupies (1..1)</text>
                    </svg>
                `,
                jobBudgetAnalysis: `
                    <svg viewBox="0 0 400 550" class="svg-flowchart" style="direction: rtl;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="200" y="15" class="header-text" text-anchor="middle">إجراءات الموازنة والترتيب</text>

                        <!-- Swimlanes -->
                        <text x="300" y="40" class="header-text" text-anchor="middle">مسؤول أقسام الموارد البشرية</text>
                        <line x1="200" y1="25" x2="200" y2="550" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>
                        
                        <text x="100" y="40" class="header-text" text-anchor="middle">مسؤول الموازنة والترتيب</text>

                        <!-- Start -->
                        <foreignObject x="225" y="60" width="150" height="120" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end" style="flex-direction:column; align-items:flex-start; text-align:right;">
                                <b>🟢 ورود القرارات:</b>
                                <ul class="list-disc pr-4 text-xs">
                                    <li>إنهاء خدمة</li>
                                    <li>إعارة / نقل / ترقية</li>
                                    <li>تعيين / إجازة / إعفاء</li>
                                    <li>وفاة</li>
                                </ul>
                            </div>
                        </foreignObject>
                        <path d="M 300 180 V 205" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Step 2 -->
                        <foreignObject x="225" y="205" width="150" height="60" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">📋 تجميع القرارات وإعداد استمارة 5</div>
                        </foreignObject>
                        <path d="M 225 235 H 150" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- Step 3 -->
                        <foreignObject x="25" y="215" width="125" height="80" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">🏛️ استلام وتسجيل القرارات في السجلات الرسمية</div>
                        </foreignObject>
                        <path d="M 87.5 295 V 320" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>

                        <!-- End -->
                        <foreignObject x="37.5" y="320" width="100" height="50" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content start-end">🏁 النهاية</div>
                        </foreignObject>
                    </svg>
                `,
                 insurancePensionAnalysis: `
                    <svg viewBox="0 0 400 600" class="svg-flowchart" style="direction: rtl; min-height: 600px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="200" y="15" class="header-text" text-anchor="middle">إجراءات اشتراكات المعاشات</text>
                        
                        <!-- Start -->
                        <foreignObject x="125" y="40" width="150" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 إعداد كشف استمارة 2 من الاستحقاقات</div>
                        </foreignObject>
                        <path d="M 200 100 V 125" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Path Split -->
                        <path d="M 200 125 H 100" class="flow-line" style="animation-delay: 0.4s;"></path>
                        <path d="M 200 125 H 300" class="flow-line" style="animation-delay: 0.4s;"></path>

                        <!-- Left Path -->
                        <path d="M 100 125 V 150" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>
                        <foreignObject x="25" y="150" width="150" height="70" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">مراجعة وتفريغ في سجل الاشتراكات (نموذج 8)</div>
                        </foreignObject>
                        <path d="M 100 220 V 245" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>
                        <foreignObject x="25" y="245" width="150" height="60" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">مطابقة مع الإدارة المالية</div>
                        </foreignObject>
                        <path d="M 100 305 V 330" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>
                        <foreignObject x="25" y="330" width="150" height="80" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content">تفريغ في استمارة 15 (نموذج 1) ونموذج تأمين صحي (نموذج 2)</div>
                        </foreignObject>

                        <!-- Right Path -->
                        <path d="M 300 125 V 150" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>
                        <foreignObject x="225" y="150" width="150" height="70" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">تعديلات الأقساط الخاصة (استمارة 5، نموذج 3 أو 4)</div>
                        </foreignObject>
                        <path d="M 300 220 V 245" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>
                        <foreignObject x="225" y="245" width="150" height="60" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">تفريغ في السجلات (نموذج 5، 6 أو 7)</div>
                        </foreignObject>
                        
                        <!-- Merge Paths -->
                        <path d="M 100 410 V 450 H 200" class="flow-line" style="animation-delay: 1.8s;"></path>
                        <path d="M 300 305 V 450 H 200" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>

                        <!-- End -->
                        <foreignObject x="125" y="475" width="150" height="60" class="flow-box" style="animation-delay: 2.0s;">
                            <div class="box-content start-end">🏁 عمل خطاب تخالص بعد انتهاء الخدمة</div>
                        </foreignObject>
                    </svg>
                `,
                 penaltiesRegisterAnalysis: `
                    <svg viewBox="0 0 400 700" class="svg-flowchart" style="direction: rtl; min-height: 700px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="200" y="15" class="header-text" text-anchor="middle">إجراءات سجل الجزاءات</text>

                        <!-- Start -->
                        <foreignObject x="125" y="40" width="150" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 بداية الإجراء</div>
                        </foreignObject>
                        <path d="M 200 100 V 125" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Step 2 -->
                        <foreignObject x="125" y="125" width="150" height="60" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">عرض على السلطة المختصة لمحو الجزاء</div>
                        </foreignObject>
                        <path d="M 200 185 V 210" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- Step 3 -->
                        <foreignObject x="125" y="210" width="150" height="60" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">إحالة الموظف للتحقيق</div>
                        </foreignObject>
                        <path d="M 200 270 V 295" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>

                        <!-- Step 4 -->
                        <foreignObject x="25" y="295" width="350" height="100" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content" style="flex-direction:column; align-items:flex-start; text-align:right;">
                                <b>⚖️ الجزاءات الموقعة:</b>
                                <ul class="list-disc pr-4 text-xs">
                                    <li>إنذار / خصم / وقف عن العمل</li>
                                    <li>تأجيل ترقية / خفض وظيفة</li>
                                    <li>فصل / إحالة للمعاش</li>
                                </ul>
                            </div>
                        </foreignObject>
                        <path d="M 200 395 V 420" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>

                        <!-- Step 5 -->
                        <foreignObject x="125" y="420" width="150" height="60" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content">الإحالة للمحاكمة التأديبية أو الجنائية</div>
                        </foreignObject>
                        <path d="M 200 480 V 505" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>
                        
                        <!-- Step 6 -->
                        <foreignObject x="125" y="505" width="150" height="60" class="flow-box" style="animation-delay: 2.0s;">
                            <div class="box-content">الوقف عن العمل (وجوبي أو احتياطي)</div>
                        </foreignObject>
                        <path d="M 200 565 V 590" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.2s;"></path>

                        <!-- End -->
                        <foreignObject x="150" y="590" width="100" height="50" class="flow-box" style="animation-delay: 2.4s;">
                            <div class="box-content start-end">🏁 النهاية</div>
                        </foreignObject>
                    </svg>
                `,
                 civilServiceRecordAnalysis: `
                    <svg viewBox="0 0 800 600" class="svg-flowchart" style="direction: rtl; min-height: 600px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="400" y="15" class="header-text" text-anchor="middle">إجراءات سجل الخدمة المدنية</text>

                        <!-- Update Records Path -->
                        <text x="650" y="40" class="header-text" text-anchor="middle">تحديث السجلات</text>
                        <foreignObject x="600" y="60" width="150" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 توزيع نموذج تحديث البيانات</div>
                        </foreignObject>
                        <path d="M 675 120 V 145" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>
                        <foreignObject x="600" y="145" width="150" height="60" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">الموظف يملأ النموذج ويرفق المستندات</div>
                        </foreignObject>
                        <path d="M 675 205 V 230" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>
                        <foreignObject x="600" y="230" width="150" height="80" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">الموظف المختص يراجع ويعد التحديثات</div>
                        </foreignObject>
                        <path d="M 675 310 V 335" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>
                        <foreignObject x="600" y="335" width="150" height="60" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">إدخال البيانات المحدثة في النظام</div>
                        </foreignObject>
                        <path d="M 675 395 V 420" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>
                        <foreignObject x="625" y="420" width="100" height="50" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content start-end">🏁 النهاية</div>
                        </foreignObject>

                        <!-- Separator Line -->
                        <line x1="400" y1="25" x2="400" y2="600" stroke="var(--border-color)" stroke-width="2" stroke-dasharray="5,5"/>

                        <!-- Create/Manage Records Path -->
                        <text x="150" y="40" class="header-text" text-anchor="middle">إنشاء وإدارة السجلات</text>
                        <foreignObject x="100" y="60" width="150" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 إنشاء ملف موظف جديد</div>
                        </foreignObject>
                        <path d="M 175 120 V 145" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>
                        <foreignObject x="100" y="145" width="150" height="60" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">تصنيف وحفظ الوثائق</div>
                        </foreignObject>
                        <path d="M 175 205 V 230" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>
                        <foreignObject x="100" y="230" width="150" height="60" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">تحديث الملف بالقرارات الجديدة</div>
                        </foreignObject>
                        <path d="M 175 290 V 315" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>
                        <foreignObject x="100" y="315" width="150" height="60" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">تحديث البيانات في النظام دوريًا</div>
                        </foreignObject>
                        <path d="M 175 375 V 400" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>
                        <foreignObject x="100" y="400" width="150" height="60" class="flow-box" style="animation-delay: 1.6s;">
                            <div class="box-content">إرسال نسخ للجهات الرسمية</div>
                        </foreignObject>
                         <path d="M 175 460 V 485" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>
                        <foreignObject x="125" y="485" width="100" height="50" class="flow-box" style="animation-delay: 2.0s;">
                            <div class="box-content start-end">🏁 النهاية</div>
                        </foreignObject>
                    </svg>
                `,
                employeeSecondmentAnalysis: `
                    <svg viewBox="0 0 800 750" class="svg-flowchart" style="direction: rtl; min-height: 750px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="400" y="15" class="header-text" text-anchor="middle">مخطط إجراءات الإعارة</text>

                        <!-- Swimlanes -->
                        <text x="725" y="40" class="header-text" text-anchor="middle">كاتب أول / رئيس قسم</text>
                        <line x1="650" y1="25" x2="650" y2="750" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>
                        
                        <text x="525" y="40" class="header-text" text-anchor="middle">مدير الموارد البشرية</text>
                        <line x1="400" y1="25" x2="400" y2="750" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="325" y="40" class="header-text" text-anchor="middle">السكرتير العام</text>
                        <line x1="250" y1="25" x2="250" y2="750" stroke="var(--border-color)" stroke-width="1.5" stroke-dasharray="4"></line>

                        <text x="125" y="40" class="header-text" text-anchor="middle">المحافظ</text>
                        
                        <!-- Start -->
                        <foreignObject x="675" y="60" width="100" height="80" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 استلام طلب الإعارة ومراجعة المستندات</div>
                        </foreignObject>
                        <path d="M 725 140 V 165" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>
                        <foreignObject x="675" y="165" width="100" height="60" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">تحرير نموذج (1) ورفعه للمدير</div>
                        </foreignObject>
                        <path d="M 675 195 H 525" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- HR Manager -->
                        <foreignObject x="425" y="175" width="100" height="80" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">عرض على لجنة الموارد البشرية وإعداد نموذج (2)</div>
                        </foreignObject>
                        <path d="M 475 255 V 280" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>

                        <!-- Governor Approval 1 -->
                        <path d="M 475 280 H 125" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.2s;"></path>
                        <foreignObject x="75" y="290" width="100" height="60" class="flow-box" style="animation-delay: 1.4s;">
                            <div class="box-content">🏛️ مراجعة وإصدار الموافقة</div>
                        </foreignObject>
                        <path d="M 125 350 V 375" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.6s;"></path>
                        <foreignObject x="75" y="375" width="100" height="60" class="flow-box" style="animation-delay: 1.8s;">
                            <div class="box-content">إعداد نموذج (3) مشروع القرار</div>
                        </foreignObject>
                        
                        <!-- General Secretary -->
                        <path d="M 125 435 H 325" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.0s;"></path>
                        <foreignObject x="275" y="415" width="100" height="60" class="flow-box" style="animation-delay: 2.2s;">
                            <div class="box-content">مراجعة مشروع القرار ورفعه</div>
                        </foreignObject>
                        
                        <!-- Governor Approval 2 -->
                        <path d="M 275 445 H 125" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.4s;"></path>
                        <foreignObject x="75" y="480" width="100" height="60" class="flow-box" style="animation-delay: 2.6s;">
                            <div class="box-content">🏛️ اعتماد القرار النهائي</div>
                        </foreignObject>
                        <path d="M 125 540 V 565" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 2.8s;"></path>
                        <foreignObject x="75" y="565" width="100" height="60" class="flow-box" style="animation-delay: 3.0s;">
                            <div class="box-content">إصدار نموذج (4) قرار الإعارة</div>
                        </foreignObject>

                        <!-- Notifications & Archiving -->
                        <path d="M 125 625 H 525" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 3.2s;"></path>
                        <foreignObject x="425" y="635" width="200" height="100" class="flow-box" style="animation-delay: 3.4s;">
                            <div class="box-content" style="flex-direction:column; align-items:flex-start; text-align:right;">
                                <b>📨 إخطار، أرشفة، وتحديث:</b>
                                <ul class="list-disc pr-4 text-xs">
                                    <li>إخطار الموظف والجهات (نموذج 5)</li>
                                    <li>حفظ في الملف وتحديث السجلات</li>
                                    <li>إبلاغ وزارة المالية</li>
                                </ul>
                            </div>
                        </foreignObject>
                    </svg>
                `,
    assignmentAnalysis: `
                    <svg viewBox="0 0 400 650" class="svg-flowchart" style="direction: rtl; min-height: 650px;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--warning-color)"></polygon>
                            </marker>
                        </defs>
                        <text x="200" y="15" class="header-text" text-anchor="middle">إجراء التكليف / الندب على وظيفة</text>

                        <!-- Start -->
                        <foreignObject x="125" y="40" width="150" height="60" class="flow-box" style="animation-delay: 0s;">
                            <div class="box-content start-end">🟢 بدء العملية (طلب/ترشيح)</div>
                        </foreignObject>
                        <path d="M 200 100 V 125" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.2s;"></path>

                        <!-- Step 2 -->
                        <foreignObject x="125" y="125" width="150" height="60" class="flow-box" style="animation-delay: 0.4s;">
                            <div class="box-content">إدخال البيانات في شاشة التكليف/الندب</div>
                        </foreignObject>
                        <path d="M 200 185 V 210" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 0.6s;"></path>

                        <!-- Step 3 -->
                        <foreignObject x="125" y="210" width="150" height="60" class="flow-box" style="animation-delay: 0.8s;">
                            <div class="box-content">مراجعة الطلب والتحقق من نوع الحركة</div>
                        </foreignObject>
                        <path d="M 200 270 V 295" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.0s;"></path>
                        
                        <!-- Step 4 -->
                        <foreignObject x="125" y="295" width="150" height="60" class="flow-box" style="animation-delay: 1.2s;">
                            <div class="box-content">اعتماد لجنة الموارد البشرية</div>
                        </foreignObject>
                        <path d="M 200 355 V 380" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.4s;"></path>

                        <!-- Decision -->
                        <g transform="translate(200, 410) rotate(45)" class="flow-box" style="animation-delay: 1.6s;">
                           <rect x="-30" y="-30" width="60" height="60" fill="#2c2a4a" stroke="var(--primary-accent)"></rect>
                           <text x="0" y="5" fill="var(--text-color)" transform="rotate(-45)" text-anchor="middle">موافقة؟</text>
                        </g>
                        
                        <!-- Paths from decision -->
                        <path d="M 221 431 L 260 470" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>
                        <text x="250" y="460" class="header-text">نعم</text>
                        <foreignObject x="225" y="470" width="100" height="70" class="flow-box" style="animation-delay: 2.0s;">
                            <div class="box-content">تنفيذ الحركة وتحديث الملفات</div>
                        </foreignObject>

                        <path d="M 179 431 L 140 470" class="flow-line" marker-end="url(#arrowhead)" style="animation-delay: 1.8s;"></path>
                        <text x="150" y="460" class="header-text">لا</text>
                        <foreignObject x="75" y="470" width="100" height="70" class="flow-box" style="animation-delay: 2.0s;">
                            <div class="box-content">تسجيل سبب الرفض وإشعار الجهة</div>
                        </foreignObject>
                        
                        <!-- Optional Cancel Path -->
                        <path d="M 275 540 H 200" class="flow-line" style="animation-delay: 2.2s;"></path>
                        <path d="M 125 540 H 200" class="flow-line" style="animation-delay: 2.2s;"></path>
                        <foreignObject x="125" y="560" width="150" height="60" class="flow-box" style="animation-delay: 2.4s;">
                            <div class="box-content">إلغاء الحركة (إن وجد)</div>
                        </foreignObject>
                    </svg>
                `
     
            };

            const hrProceduresData = [
                {
                    category: "التطوير المؤسسي",
                    procedures: [
                        { id: "dev-process", name: "عملية التطوير المؤسسي", stages: { analysis: 'completed', design: 'completed', development: 'inprogress', deployment: 'pending', golive: 'pending' }, 
                          details: { 
                              analysis: { flowchartId: 'professionalDevProcess' },
                              design: {
                                  images: [
                                      { url: './images/h.png', alt: 'الهيكل التنظيمي', caption: 'تصميم الهيكل التنظيمي الجديد' },
                                  ]
                              }
                          } 
                        },
                        { id: "job-budget-form", name: "استمارة موازنة الوظائف والترتيب", stages: { analysis: 'completed', design: 'inprogress', development: 'pending', deployment: 'pending', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'jobBudgetAnalysis' },
                              design: {
                                  images: [
                                      { url: './images/h.png', alt: 'الهيكل التنظيمي', caption: 'تصميم الهيكل التنظيمي الجديد' },
                                  ]
                              }
                                     }
                        }
                    ]
                },
                {
                    category: "إدارة وتنمية المواهب",
                    procedures: [
                        { id: "training-procedures", name: "إجراءات التدريب", stages: { analysis: 'completed', design: 'completed', development: 'completed', deployment: 'inprogress', golive: 'pending' }, 
                          details: { 
                              analysis: { flowchartId: 'trainingAnalysisFlowchart' },
                              design: {
                                  images: [
                                      { url: './images/التدريب.png', alt: 'الهيكل التنظيمي', caption: 'تصميم الهيكل التنظيمي الجديد' },
                                  ]
                              }
                          } 
                        },
                        { id: "performance-appraisal", name: "إجراء تقويم الأداء", stages: { analysis: 'completed', design: 'completed', development: 'completed', deployment: 'inprogress', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'performanceAppraisalAnalysis' },
                              design: {
                                  images: [
                                      { url: './images/تقييم الاداء من المدير المباشر.png', alt: 'الهيكل التنظيمي', caption: 'تصميم الهيكل التنظيمي الجديد' },
                                      { url: './images/تقييم من الرئيس الاعلي.png', alt: 'الهيكل التنظيمي', caption: 'تصميم الهيكل التنظيمي الجديد' },
                                      { url: './images/قياس اثر التدريب .png', alt: 'الهيكل التنظيمي', caption: 'تصميم الهيكل التنظيمي الجديد' },

                                    ]
                              }
                          }
                        },
                        { id: "performance-grievances", name: "تظلمات تقييم الأداء", stages: { analysis: 'completed', design: 'completed', development: 'completed', deployment: 'inprogress', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'performanceGrievancesAnalysis' },
                              design: {
                                  images: [
                                      { url: './images/تظلم عن تقييم اداء.png', alt: 'الهيكل التنظيمي', caption: 'تصميم الهيكل التنظيمي الجديد' },
                                      { url: './images/الموافقة عن تظلم التقييم.png', alt: 'الهيكل التنظيمي', caption: 'تصميم الهيكل التنظيمي الجديد' },
                                      ]
                              }
                          }
                        }
                    ]
                },
                {
                    category: "الاستحقاقات والمزايا",
                    procedures: [
                        { id: "insurance-pension-subscriptions", name: "إجراءات اشتراكات التأمين والمعاشات", stages: { analysis: 'completed', design: 'completed', development: 'completed', deployment: 'completed', golive: 'inprogress' }, 
                          details: {
                              analysis: { flowchartId: 'insurancePensionAnalysis' },
                              design: {
                                  images: [
                                      { url: './images/اشتراكات التامين.png', alt: 'الهيكل التنظيمي', caption: 'تصميم الهيكل التنظيمي الجديد' },
                                     ]
                              }
                            }
                        },
                        { id: "solidarity-fund-disbursement", name: "صندوق التكافل – صرف مستحقات التكافل", stages: { analysis: 'completed', design: 'completed', development: 'completed', deployment: 'inprogress', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'solidarityFundAnalysis' },
                              design : {
                                    images: [
                                        { url: './images/اشتراكات صندوق التكافل.png', alt: 'نموذج تصميم 1', caption: 'نموذج تصميم الشاشة الرئيسية' },
                                        { url: './images/صرف مستحقات صندوق التكافل.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                        { url: './images/صندوق التكافل بالمشاركيين.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' }

                                    ]
                                }
                          }
                        },
                        { id: "illicit-gain-procedure", name: "إجراء كسب غير مشروع", stages: { analysis: 'completed', design: 'completed', development: 'inprogress', deployment: 'pending', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'illicitGainAnalysis' }
                          }
                        },
                        { id: "settlement-procedures", name: "إجراء التسوية بأنواعها", stages: { analysis: 'completed', design: 'completed', development: 'completed', deployment: 'inprogress', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'settlementAnalysis' },
                              design : {
                                    images: [
                                        { url: './images/تسوية ضم مدة.png', alt: 'نموذج تصميم 1', caption: 'نموذج تصميم الشاشة الرئيسية' },
                                        { url: './images/الموافقة علي تسوية ضم مدة.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                        { url: './images/تسوية مؤهل علمي.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                        { url: './images/الموافقة علي تسوئة مؤهل علمي.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' }
                                    ]
                                }
                          } 
                        },
                        { id: "allowance-procedures", name: "إجراء العلاوات بأنواعها", stages: { analysis: 'completed', design: 'completed', development: 'completed', deployment: 'inprogress', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'allowancesAnalysis' },
                              design : {
                                    images: [
                                        { url: './images/العلاوات.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' }
                                    ]
                                }
                          }
                        }
                    ]
                },
                {
                    category: "عمليات الموارد البشرية",
                    procedures: [
                        { id: "employee-hiring", name: "إجراء تعيين موظف", stages: { analysis: 'completed', design: 'completed', development: 'completed', deployment: 'inprogress', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'employeeHiringAnalysis' },
                              design : {
                                    images: [
                                        { url: './images/طلبات التعيين والمرشحون عليها.PNG', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' }
                                    ]
                                }
                          }
                        },
                        { id: "employee-transfer", name: "إجراء نقل موظف بأنواعه", stages: { analysis: 'completed', design: 'completed', development: 'inprogress', deployment: 'pending', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'employeeTransferAnalysis' },
                              design : {
                                    images: [
                                        { url: './images/طلب النقل بانواعه.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                        { url: './images/الموافقة علي طلب النقل .png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' }
                                    ]
                                }
                          }
                        },
                        { id: "employee-secondment", name: "إجراء إعارة موظف", stages: { analysis: 'completed', design: 'inprogress', development: 'pending', deployment: 'pending', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'employeeSecondmentAnalysis' },
                              design : {
                                    images: [
                                        { url: './images/طلب اعارة.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                        { url: './images/الموافقة علي الاعارة.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                        { url: './images/طلب تجدبد الاعارة.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                        { url: './images/طلب انهاء الاعارة.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' }
                                    ]
                                }
                          } 
                        },
                        { id: "employee-deputation", name: "إجراء ندب موظف", stages: { analysis: 'completed', design: 'completed', development: 'inprogress', deployment: 'pending', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'employeeDeputationAnalysis' },
                              design : {
                                    images: [
                                        { url: './images/طلب الندب بانواعه.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                        { url: './images/طلب تجديد الندب.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                        { url: './images/طلب انهاء الندب.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                    ]
                                }
                          } 
                        },
                        { id: "leave-procedures", name: "إجراء الإجازات بأنواعها", stages: { analysis: 'completed', design: 'completed', development: 'completed', deployment: 'inprogress', golive: 'pending' }, details: { 
                            analysis: { flowchartId: 'leaveProcessAnalysis' },
                            design: {
                                images: [
                                    { url: './images/طلب اجازة.png', alt: 'نموذج تصميم 1', caption: 'نموذج تصميم الشاشة الرئيسية' },
                                    { url: './images/الموافقة علي طلبات اجازة.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                ]
                            }    
                        } 
                    },
                        { id: "work-injury-procedure", name: "إجراء إصابة عمل", stages: { analysis: 'completed', design: 'inprogress', development: 'pending', deployment: 'pending', golive: 'pending' }, details: { analysis: { flowchartId: 'workInjuryAnalysis' } } },
                        { id: "penalties-grievances", name: "إجراء الجزاءات والتظلمات", stages: { analysis: 'completed', design: 'completed', development: 'completed', deployment: 'inprogress', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'penaltiesGrievancesAnalysis' },
                              design : {
                                    images: [
                                        { url: './images/الجزاءات.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                    ]
                                }
                          } 
                        },
                        { id: "penalties-register", name: "سجل الجزاءات", stages: { analysis: 'completed', design: 'completed', development: 'inprogress', deployment: 'pending', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'penaltiesRegisterAnalysis' },
                              design : {
                                    images: [
                                        { url: './images/الجزاءات.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                    ]
                                }
                          } 
                        },
                        { id: "service-termination", name: "إجراء إنهاء خدمة موظف", stages: { analysis: 'completed', design: 'completed', development: 'completed', deployment: 'completed', golive: 'inprogress' }, 
                          details: {
                              analysis: { flowchartId: 'serviceTerminationAnalysis' },
                              design : {
                                    images: [
                                        { url: './images/انهاء خدمة.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                    ]
                                }
                          } 
                        },
                        { id: "promotion-procedure", name: "إجراء حركة الترقية", stages: { analysis: 'completed', design: 'completed', development: 'completed', deployment: 'inprogress', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'promotionAnalysis' },
                              design : {
                                    images: [
                                        { url: './images/الترقيات.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                        { url: './images/المسابقات.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                    ]
                                }
                          } 
                        },
                        { id: "assignment-procedure", name: "التكليف / الندب على وظيفة", stages: { analysis: 'completed', design: 'completed', development: 'inprogress', deployment: 'pending', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'assignmentAnalysis' },
                              design : {
                                    images: [
                                        { url: './images/تكليف وندب علي وظيفة.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                        { url: './images/الموافقة علي تكليف وندب علي وظيفة.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                        { url: './images/انهاء التكليف والندب علي الوظيفة.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                    ]
                                }
                          }
                        },
                        { id: "civil-service-record", name: "سجل الخدمة المدنية", stages: { analysis: 'completed', design: 'completed', development: 'completed', deployment: 'inprogress', golive: 'pending' }, 
                          details: {
                              analysis: { flowchartId: 'civilServiceRecordAnalysis' },
                              design : {
                                    images: [
                                        { url: './images/سجل الخدمة المدنية.png', alt: 'نموذج تصميم 2', caption: 'نموذج تصميم شاشة التقارير' },
                                    ]
                                }
                          }
                        }
                    ]
                }
            ];

            // --- UI Elements ---
            const listContainer = document.getElementById('procedures-list');
            const detailsPanel = document.getElementById('procedure-details-panel');
            const asisTobeDescription = document.getElementById('asis-tobe-description');
            const infoNodes = document.querySelectorAll('.info-node');

            // --- Functions ---
            function setupAsIsToBeDiagram() {
                infoNodes.forEach(node => {
                    node.addEventListener('click', () => {
                        infoNodes.forEach(n => n.classList.remove('active'));
                        node.classList.add('active');
                        asisTobeDescription.innerHTML = `<p class="font-semibold">${node.dataset.desc}</p>`;
                    });
                });
            }

            function renderProceduresList() {
                listContainer.innerHTML = '';
                hrProceduresData.forEach(category => {
                    const accordionItem = document.createElement('div');
                    accordionItem.className = 'accordion-item';

                    const header = document.createElement('div');
                    header.className = 'accordion-header';
                    header.innerHTML = `
                        <h4 class="text-md font-bold text-pink-400">${category.category}</h4>
                        <svg class="chevron w-6 h-6 text-pink-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    `;
                    
                    const content = document.createElement('div');
                    content.className = 'accordion-content pr-4 pt-2';

                    category.procedures.forEach(procedure => {
                        const item = document.createElement('div');
                        item.className = 'procedure-item text-slate-300';
                        item.textContent = procedure.name;
                        item.dataset.id = procedure.id;
                        item.addEventListener('click', (e) => {
                            e.stopPropagation();
                            renderProcedureDetails(procedure.id);
                            document.querySelectorAll('.procedure-item').forEach(el => el.classList.remove('active'));
                            item.classList.add('active');
                        });
                        content.appendChild(item);
                    });

                    header.addEventListener('click', () => {
                        const isOpen = header.classList.contains('open');
                        document.querySelectorAll('.accordion-header.open').forEach(h => {
                            if (h !== header) {
                                h.classList.remove('open');
                                h.nextElementSibling.style.maxHeight = null;
                            }
                        });
                        
                        if (!isOpen) {
                            header.classList.add('open');
                            content.style.maxHeight = content.scrollHeight + "px";
                        } else {
                            header.classList.remove('open');
                            content.style.maxHeight = null;
                        }
                    });

                    accordionItem.appendChild(header);
                    accordionItem.appendChild(content);
                    listContainer.appendChild(accordionItem);
                });
            }

            function renderProcedureDetails(procedureId) {
                detailsPanel.innerHTML = `<div class="spinner"></div>`;
                
                setTimeout(() => {
                    const procedureData = hrProceduresData.flatMap(c => c.procedures).find(p => p.id === procedureId);
                    if (!procedureData) {
                        detailsPanel.innerHTML = `<p class="text-center text-slate-400 py-16">لم يتم العثور على الإجراء.</p>`;
                        return;
                    }

                    let stepperHtml = '<div class="procedure-stepper">';
                    const stages = Object.keys(stageDetails);
                    
                    stages.forEach((stageKey, index) => {
                        const status = procedureData.stages[stageKey];
                        const detail = stageDetails[stageKey];
                        stepperHtml += `<div class="step ${status}" data-stage-key="${stageKey}" data-procedure-id="${procedureId}">
                                            <div class="step-icon">${detail.icon}</div>
                                            <div class="step-label">${detail.label}</div>
                                        </div>`;
                        if (index < stages.length - 1) {
                            const nextStageStatus = procedureData.stages[stages[index+1]];
                            const lineStatus = status === 'completed' && nextStageStatus !== 'pending' ? 'completed' : 'pending';
                            stepperHtml += `<div class="step-line ${lineStatus}"></div>`;
                        }
                    });
                    stepperHtml += '</div>';

                    detailsPanel.innerHTML = `
                        <div class="details-content-wrapper loading w-full">
                            <h3 class="text-2xl font-bold text-indigo-300 mb-4 pb-4 border-b border-slate-700">${procedureData.name}</h3>
                            <div>
                                <h4 class="text-lg font-semibold text-teal-300 mb-2">خط سير العمل</h4>
                                ${stepperHtml}
                            </div>
                            <div id="stage-specific-details" class="mt-6"></div>
                        </div>
                    `;
                    
                    detailsPanel.querySelectorAll('.step').forEach(stepEl => {
                        stepEl.addEventListener('click', (e) => {
                            const target = e.currentTarget;
                            renderStageSpecificDetails(target.dataset.procedureId, target.dataset.stageKey);
                            detailsPanel.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
                            target.classList.add('active');
                        });
                    });

                    const inProgressStage = stages.find(key => procedureData.stages[key] === 'inprogress');
                    const firstStage = stages[0];
                    const defaultStageToShow = inProgressStage || firstStage;

                    renderStageSpecificDetails(procedureId, defaultStageToShow);
                    detailsPanel.querySelector(`.step[data-stage-key='${defaultStageToShow}']`).classList.add('active');

                    setTimeout(() => {
                        detailsPanel.querySelector('.details-content-wrapper').classList.remove('loading');
                    }, 50);

                }, 500);
            }

            function renderStageSpecificDetails(procedureId, stageKey) {
                const procedureData = hrProceduresData.flatMap(c => c.procedures).find(p => p.id === procedureId);
                const stageDetail = stageDetails[stageKey];
                const procedureStageDetail = procedureData.details ? procedureData.details[stageKey] : null;
                const container = document.getElementById('stage-specific-details');

                if (!container) return;

                let stageContentHTML = '';

                switch (stageKey) {
                    case 'analysis':
                        let flowchartContent = `<h5 class="text-md font-bold text-pink-400 mb-3">مخطط سير العمل</h5><div class="bg-black/20 p-4 rounded-lg flex justify-center items-center min-h-[150px] text-slate-400">`;
                        if (procedureStageDetail?.flowchartId && flowchartLibrary[procedureStageDetail.flowchartId]) {
                            flowchartContent += flowchartLibrary[procedureStageDetail.flowchartId];
                        } else {
                            flowchartContent += `<span>لا يوجد مخطط متاح لهذه المرحلة.</span>`;
                        }
                        flowchartContent += `</div>`;
                        stageContentHTML = flowchartContent;
                        break;
                    
                    case 'design':
                        let imageContent = `<h5 class="text-md font-bold text-pink-400 mb-3">صور توضيحية</h5>`;
                        if (procedureStageDetail?.images && procedureStageDetail.images.length > 0) {
                            imageContent += '<div class="grid grid-cols-1 md:grid-cols-2 gap-4">';
                            procedureStageDetail.images.forEach(img => {
                                imageContent += `
                                    <div class="bg-black/20 p-2 rounded-lg">
                                        <img src="${img.url}" alt="${img.alt}" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                        <p class="text-center text-sm mt-2 text-slate-400">${img.caption}</p>
                                    </div>
                                `;
                            });
                            imageContent += '</div>';
                        } else {
                            imageContent += `<div class="bg-black/20 p-4 rounded-lg flex justify-center items-center min-h-[150px] text-slate-400"><span>لا توجد صور متاحة لهذه المرحلة.</span></div>`;
                        }
                        stageContentHTML = imageContent;
                        break;

                    case 'development':
                        stageContentHTML = `
                            <h5 class="text-md font-bold text-pink-400 mb-3">نماذج الشاشات المقترحة</h5>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-black/20 p-2 rounded-lg">
                                    <img src="./images/1.PNG" alt="مثال للشاشة 1" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images/2.PNG" alt="مثال للشاشة 1" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images/3.PNG" alt="مثال للشاشة 1" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images/4.PNG" alt="مثال للشاشة 1" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images/5.PNG" alt="مثال للشاشة 1" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images/6.PNG" alt="مثال للشاشة 1" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images/7.PNG" alt="مثال للشاشة 1" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images/8.PNG" alt="مثال للشاشة 1" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <p class="text-center text-sm mt-2 text-slate-400">شاشة إدخال البيانات الرئيسية</p>
                                </div>
                                <div class="bg-black/20 p-2 rounded-lg">
                                    <img src="./images2/55.png" alt="مثال للشاشة 2" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images2/ChatGPT Image Aug 11, 2025, 12_53_08 AM.png" alt="مثال للشاشة 2" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images2/Capture.PNG" alt="مثال للشاشة 2" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images2/2.PNG" alt="مثال للشاشة 2" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images2/3.PNG" alt="مثال للشاشة 2" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images2/4.PNG" alt="مثال للشاشة 2" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images2/5.PNG" alt="مثال للشاشة 2" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images2/6.PNG" alt="مثال للشاشة 2" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <img src="./images2/ChatGPT Image Aug 11, 2025, 12_53_08 AM.png" alt="مثال للشاشة 2" class="w-full h-auto rounded-md" onerror="this.src='https://placehold.co/600x400/0a0a1a/e5e7eb?text=Image+Not+Found'">
                                    <p class="text-center text-sm mt-2 text-slate-400">شاشة التقارير والتحليلات</p>
                                </div>
                            </div>
                        `;
                        break;

                    case 'deployment':
                        stageContentHTML = `
                            <h5 class="text-md font-bold text-pink-400 mb-3">فيديو تدريبي للمستخدمين</h5>
                            <div class="bg-black/20 p-4 rounded-lg flex justify-center items-center aspect-video">
                                 <div class="text-center text-slate-400">
                                    <svg class="w-16 h-16 mx-auto text-slate-500" fill="currentColor" viewBox="0 0 20 20"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"></path></svg>
                                    <video class="w-full h-auto mt-4" controls>
                                        <source src="./30.mp4" type="video/mp4">
                                        متصفحك لا يدعم تشغيل الفيديو.
                                    <p class="mt-2">عرض فيديو تدريبي (مثال)</p>
                                </div>
                            </div>
                        `;
                        break;

                    case 'golive':
                        stageContentHTML = `
                            <h5 class="text-md font-bold text-pink-400 mb-3">فيديو إطلاق النظام</h5>
                             <div class="bg-black/20 p-4 rounded-lg flex justify-center items-center aspect-video">
                                 <div class="text-center text-slate-400">
                                    <svg class="w-16 h-16 mx-auto text-slate-500" fill="currentColor" viewBox="0 0 20 20"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"></path></svg>
                                   <video class="w-full h-auto mt-4" controls>
                                        <source src="./31.mp4" type="video/mp4">
                                        متصفحك لا يدعم تشغيل الفيديو.
                                    <p class="mt-2">عرض فيديو إطلاق النظام (مثال)</p>
                                </div>
                            </div>
                        `;
                        break;

                    default:
                        stageContentHTML = `<div class="text-center text-slate-400">لا توجد تفاصيل متاحة لهذه المرحلة.</div>`;
                }

                const contentWrapper = document.createElement('div');
                contentWrapper.className = 'details-content-wrapper loading';
                contentWrapper.innerHTML = `
                    <div class="bg-slate-800/50 p-4 rounded-lg border-l-4 border-sky-500">
                        <h4 class="text-lg font-bold text-sky-400 mb-2">تفاصيل مرحلة: ${stageDetail.label}</h4>
                        <p class="text-slate-300">${stageDetail.description}</p>
                    </div>
                    <div class="mt-4">
                        ${stageContentHTML}
                    </div>
                `;
                container.innerHTML = '';
                container.appendChild(contentWrapper);
                
                setTimeout(() => contentWrapper.classList.remove('loading'), 50);
            }


            // --- Initial calls ---
            setupAsIsToBeDiagram();
            renderProceduresList();
            
            if (hrProceduresData.length > 0 && hrProceduresData[0].procedures.length > 0) {
                const firstProcedureId = hrProceduresData[0].procedures[0].id;
                renderProcedureDetails(firstProcedureId);
                document.querySelector(`.procedure-item[data-id='${firstProcedureId}']`).classList.add('active');
                
                const firstAccordionHeader = document.querySelector('.accordion-header');
                if(firstAccordionHeader) {
                    firstAccordionHeader.classList.add('open');
                    firstAccordionHeader.nextElementSibling.style.maxHeight = firstAccordionHeader.nextElementSibling.scrollHeight + "px";
                }

            } else {
                 detailsPanel.innerHTML = `<div class="text-center text-slate-400 py-16"><p>لا توجد إجراءات لعرضها.</p></div>`;
            }
        });
    </script>
</body>
</html>
